#:kivy 2.3.0
#:import utils kivy.utils

<MainScreen>:
    BoxLayout:
        orientation: 'horizontal'
        canvas:
            Color:
                rgb: 0.5,0.5,0.5
            Rectangle:
                size: self.size
        FloatLayout:
            size_hint: (1,1)
            canvas.before:
                Color:
                    rgb: utils.get_color_from_hex('#E0E0E0')
                Rectangle:
                    size: self.size
            PlantWidget:
                pos: (200, 230)
                size_hint: (None,None)
            
            BoxLayout:
                size_hint: (None,None)
                size: (330,self.parent.height - 100)
                pos: (100,50)
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex('#A0A0A4')
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
            
            BoxLayout:
                size_hint: (None,None)
                size: (330,self.parent.height - 100)
                pos: (450,50)
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex('#A0A0A4')
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
            
            Button:
                id: xv1_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,850)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(1)
            
            Button:
                id: xv2_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,730)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(2)

            Button:
                id: xv3_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,611)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(3)
            
            Button:
                id: xv4_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,492)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(4)
            
            Button:
                id: xv5_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,373)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(5)

            Button:
                id: xv6_btn
                size_hint: (None,None)
                size: (60,40)
                pos: (1118,255)
                background_color: 0, 0, 0, 0
                on_release: root.switch_xv(6)

            BoxLayout:
                id: info_motor
                orientation: 'vertical'
                pos: (180,450)
                size: (180,180)
                size_hint: (None,None)
                spacing: 10
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Torque'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.torque
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' Nm'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Velocidade'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.vel
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' RPM'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Temp. da carcaça'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.temp_carc
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' °C'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Temp. da fase R'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.temp_r
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' °C'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Temp. da fase S'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.temp_s
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' °C'
                BoxLayout:
                    orientation: 'vertical'
                    spacing: 3
                    size_hint_y: None
                    height: 40
                    Label:
                        text: 'Temp. da fase T'
                        halign: "left"
                        text_size: self.size
                        color: utils.get_color_from_hex('#3F3F3F')
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            id: co.temp_t
                            color: utils.get_color_from_hex('#475CA7')
                            halign: "right"
                            text_size: self.size
                            text: '-'
                        Label:
                            color: utils.get_color_from_hex('#919191')
                            halign: "right"
                            text_size: self.size
                            text: ' °C'
            
            BoxLayout:
                orientation: 'vertical'
                spacing: 3
                size_hint: (None,None)
                size: (60,40)
                pos: (800,880)
                Label:
                    text: 'FV-01'
                    halign: "left"
                    color: utils.get_color_from_hex('#3F3F3F')
                BoxLayout:
                    orientation: 'horizontal'
                    Label:
                        id: co.fv01
                        color: utils.get_color_from_hex('#475CA7')
                        halign: "left"
                        size_hint_x: None
                        width: 40
                        text: '-'
                    Label:
                        color: utils.get_color_from_hex('#919191')
                        halign: "right"
                        text: ' %'

            BoxLayout:
                orientation: 'vertical'
                spacing: 3
                size_hint: (None,None)
                size: (110,40)
                pos: (960,880)
                Label:
                    text: 'FIT-02'
                    halign: "left"
                    color: utils.get_color_from_hex('#3F3F3F')
                BoxLayout:
                    orientation: 'horizontal'
                    Label:
                        id: co.fit02
                        color: utils.get_color_from_hex('#475CA7')
                        halign: "left"
                        size_hint_x: None
                        width: 40
                        text: '-'
                    Label:
                        color: utils.get_color_from_hex('#919191')
                        halign: "right"
                        text: ' Nm²/min'
            
            BoxLayout:
                orientation: 'vertical'
                spacing: 3
                size_hint: (None,None)
                size: (110,40)
                pos: (838,760)
                Label:
                    text: 'FIT-03'
                    halign: "left"
                    color: utils.get_color_from_hex('#3F3F3F')
                BoxLayout:
                    orientation: 'horizontal'
                    Label:
                        id: co.fit03
                        color: utils.get_color_from_hex('#475CA7')
                        halign: "left"
                        size_hint_x: None
                        width: 40
                        text: '-'
                    Label:
                        color: utils.get_color_from_hex('#919191')
                        halign: "right"
                        text: ' Nm²/min'


            

            Button:
                size_hint: (None, None)
                size: (0.65*62, 0.65*58)
                background_normal: 'imgs/graph_icon.jpg'
                background_down: 'imgs/graph_icon.jpg'
                pos_hint: {'x': 0,'y': 0}
                on_release:
                    root._graph.open()

        BoxLayout:
            orientation: 'vertical'
            spacing: 10
            size_hint: (None,1)
            width: 400
            padding: [20]
            Label:
                text: 'Controle do motor'
                halign: "left"
                text_size: self.size
                size_hint_y: None
                bold: True
                font_size: 23
                height: 50
            Label:
                text: 'Tipo de partida'
                halign: "left"
                text_size: self.size
                size_hint_y: None
                height: 50
            BoxLayout:
                orientation: 'horizontal'
                height: 40
                size_hint_y: None
                ToggleButton:
                    id: softstart
                    text: 'Soft'
                    group: 'partida'
                    on_release: root._modbus_client.set_seldriver(1)
                ToggleButton:
                    id: invstart
                    text: 'Inversor'
                    group: 'partida'
                    on_release: root._modbus_client.set_seldriver(2)
                ToggleButton:
                    id: dirstart
                    text: 'Direta'
                    group: 'partida'
                    on_release: root._modbus_client.set_seldriver(3)
            Label:
                text: 'Controle liga/desliga'
                halign: "left"
                text_size: self.size
                size_hint_y: None
                height: 50
            BoxLayout:
                orientation: 'horizontal'
                spacing: 5
                size_hint_y: None
                height: 40
                Button:
                    text: 'Ligar'
                    on_release: root.start_engine()
                Button:
                    text: 'Desligar'
                    on_release: root.stop_engine()
                Button:
                    text: 'Reset'
                    on_release: root.reset_engine()

            Label:
                text: 'Frequência do inversor'
                halign: "left"
                text_size: self.size
                size_hint_y: None
                height: 50
            BoxLayout:
                orientation: 'vertical'
                size_height_y: None
                height: 70
                Slider:
                    id: inv_freq
                    min: 0
                    max: 60
                    step: 0.1
                    orientation: 'horizontal'
                    on_touch_up:
                        root._modbus_client.set_freq(round(inv_freq.value,1))
                Label:
                    text: str(round(inv_freq.value,1)) + ' Hz'
            
            Label:
                text: 'Controle de válvulas'
                halign: "left"
                text_size: self.size
                size_hint_y: None
                bold: True
                font_size: 23
                height: 50

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV1'
                    halign: 'left'
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv1_switch

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV2'
                    halign: "left"
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv2_switch

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV3'
                    halign: "left"
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv3_switch

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV4'
                    halign: "left"
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv4_switch

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV5'
                    halign: "left"
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv5_switch

            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'XV6'
                    halign: "left"
                    valign: 'middle'
                    size_hint: (1,1)
                    text_size: self.size
                Switch:
                    id: xv6_switch

            Button:
                text: 'Configurações'
                size_hint_y: None
                height: 40
                on_release: root._settings_popup.open()
            
            Image:
                id: img_con
                size_hint_x: None
                width: 80
                source: 'imgs/desconectado.png'
                pos_hint: {'top': 1, 'right': 1} 